"use strict";(self.webpackChunkag_curl=self.webpackChunkag_curl||[]).push([[178],{3178:(G,x,m)=>{m.r(x),m.d(x,{SimulatorModule:()=>z});var h=m(9808),O=m(9140);function v(o,r,t,a,s,c,n){try{var l=o[c](n),d=l.value}catch(f){return void t(f)}l.done?r(d):Promise.resolve(d).then(a,s)}function w(o){return function(){var r=this,t=arguments;return new Promise(function(a,s){var c=o.apply(r,t);function n(d){v(c,a,s,n,l,"next",d)}function l(d){v(c,a,s,n,l,"throw",d)}n(void 0)})}}var y=m(1135),A=m(2076),M=m(4464);class g{constructor(r){this.teamData={},r.forEach(t=>{t.homeTeamAbbr in this.teamData||(this.teamData[t.homeTeamAbbr]={score:0,round:0,results:[]}),t.awayTeamAbbr in this.teamData||(this.teamData[t.awayTeamAbbr]={score:0,round:0,results:[]}),this.teamData[t.homeTeamAbbr].score+=t.homeAwardedPoints,this.teamData[t.homeTeamAbbr].round=Math.max(this.teamData[t.homeTeamAbbr].round,t.round),this.teamData[t.homeTeamAbbr].results.push(t),this.teamData[t.awayTeamAbbr].score+=t.awayAwardedPoints,this.teamData[t.awayTeamAbbr].round=Math.max(this.teamData[t.awayTeamAbbr].round,t.round),this.teamData[t.awayTeamAbbr].results.push(t)})}add(r){for(const[t,a]of Object.entries(r.teamData))this.teamData[t].round+=a.round,this.teamData[t].score+=a.score;return this}divide(r){for(const t of Object.keys(this.teamData))this.teamData[t].round/=r,this.teamData[t].score/=r;return this}raw(){const r=[];for(const[t,a]of Object.entries(this.teamData))r.push({abbr:t,score:a.score,round:a.round});return r.sort((t,a)=>a.score-t.score)}static blank(r){const t=new g([]);return r.all().forEach(a=>{a.rank>0&&(t.teamData[a.abbr]={score:0,round:0,results:[]})}),t}}var e=m(1223),P=m(9669),T=m(9771),D=m(8335),S=m(8526),b=m(5560);function _(o,r){if(1&o&&(e.TgZ(0,"div",2),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.AsE("Progress (",t.iterations," Iterations): ",(t.iterate/t.iterations*100).toFixed(0),"%")}}function Z(o,r){if(1&o&&(e.TgZ(0,"mat-grid-list",5)(1,"mat-grid-tile",6)(2,"div",2),e._uU(3),e.qZA()(),e.TgZ(4,"mat-grid-tile",6)(5,"div",2),e._uU(6),e.qZA()()()),2&o){const t=r.$implicit;e.xp6(3),e.Oqu(t[0]),e.xp6(3),e.hij("",t[1],"%")}}function F(o,r){if(1&o&&(e.TgZ(0,"div",3),e.YNc(1,Z,7,2,"mat-grid-list",4),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.metaDraftSorted)}}function E(o,r){if(1&o&&(e.TgZ(0,"mat-grid-list",8)(1,"mat-grid-tile",6)(2,"div",2),e._UZ(3,"img",9),e._uU(4),e.qZA()(),e.TgZ(5,"mat-grid-tile",6)(6,"div",2),e._uU(7),e.qZA()(),e.TgZ(8,"mat-grid-tile",6)(9,"div",2),e._uU(10),e.qZA()()()),2&o){const t=r.$implicit,a=e.oxw(2);e.xp6(3),e.s9C("src",a.teamdb.get(t.abbr).imgURL,e.LSH),e.xp6(1),e.Oqu(a.teamdb.get(t.abbr).cleanName()),e.xp6(3),e.Oqu(t.score.toFixed(3)),e.xp6(3),e.Oqu(t.round.toFixed(2))}}function N(o,r){if(1&o&&(e.TgZ(0,"div",3),e.YNc(1,E,11,4,"mat-grid-list",7),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.metaResult.raw())}}const R=o=>new Promise(r=>setTimeout(r,o));function I(o,r){o.forEach(a=>{a.group&&(r[a.group][a.homeTeamAbbr].score+=a.homeAwardedPoints,r[a.group][a.homeTeamAbbr].simulations.push(a),r[a.group][a.awayTeamAbbr].score+=a.awayAwardedPoints,r[a.group][a.awayTeamAbbr].simulations.push(a))});const t={};for(const[a,s]of Object.entries(r)){a in t||(t[a]=[]);for(const[c,n]of Object.entries(s))t[a].push({abbr:c,logOdds:n.logOdds,score:n.score});t[a].sort((c,n)=>{const l=s[c.abbr],d=s[n.abbr];if(l.score===d.score){const f=l.simulations.filter(u=>u.homeTeamAbbr===n.abbr||u.awayTeamAbbr===n.abbr);if(0===f.length)return Math.random()-.5;const i=f[0];return i.homeAwardedPoints===i.awayAwardedPoints?Math.random()-.5:i.winnerTeamAbbr===c.abbr?-1:1}return d.score-l.score})}return t}const Y=[{path:"",component:(()=>{class o{constructor(t,a,s,c){this.fifaapi=t,this.teamdb=a,this.userdb=s,this.draftdb=c,this.iterate=0,this.iterations=5e4}ngOnInit(){var t=this;return w(function*(){t.allGamesSub$=new y.X(new Array),t.allGames$=t.allGamesSub$.asObservable(),t.allDrafts$=(0,A.D)([t.draftdb.drafts]),t.updateGames().then(function(){var a=w(function*(s){s.sort((n,l)=>n.id-l.id),t.metaResult=g.blank(t.teamdb),t.metaDraft={},t.userdb.all().forEach(n=>{t.metaDraft[n.name]=[0,0,0,0,0,0,0,0]});let c=0;for(t.iterate=0;t.iterate<t.iterations;t.iterate++){t.iterate%500==0&&(yield R(0));const n=[];s.forEach(i=>i.initalizeFromResult()),t.teamdb.all().forEach(i=>i.resetGames()),s.filter(i=>0===i.round).forEach(i=>{n.push(i.simulate(!0,n))});const l=I(n,t.teamdb.teamsByGroup());s.filter(i=>i.round>0).forEach(i=>{n.push(i.simulate(!1,n,l))});const d=new g(n);t.metaResult.add(d);const f=[];t.draftdb.drafts.forEach(i=>{const u=[];let C=0;i.teams.forEach(p=>{u.push([p.abbr,d.teamData[p.abbr]]),C+=d.teamData[p.abbr].score}),f.push([i.user.name,C,u])}),f.sort((i,u)=>Number(u[1])-Number(i[1]));for(let i=0,u=0;i<f.length;i++)i>0&&(f[i-1][1]!==f[i][1]?u=i:1===i&&(console.log(f),c++)),t.metaDraft[String(f[i][0])][u]++}console.log(c),console.log(c/t.iterations),console.log(t.metaDraft),t.metaResult.divide(t.iterations),t.metaDraftSorted=[];for(const[n,l]of Object.entries(t.metaDraft))t.metaDraftSorted.push([n,l[0]/(t.iterations/100)]);t.metaDraftSorted.sort((n,l)=>Number(l[1])-Number(n[1])),t.allGamesSub$.next(s.filter(n=>n.round>=0))});return function(s){return a.apply(this,arguments)}}())})()}updateGames(){return(0,M.n)(this.fifaapi.getGames())}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(P.d),e.Y36(T.Y),e.Y36(D.C),e.Y36(S.H))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-simulator"]],decls:3,vars:3,consts:[["class","game-status",4,"ngIf"],["class","list-container",4,"ngIf"],[1,"game-status"],[1,"list-container"],["cols","2","rowHeight","2em",4,"ngFor","ngForOf"],["cols","2","rowHeight","2em"],["colspan","1"],["cols","3","rowHeight","2em",4,"ngFor","ngForOf"],["cols","3","rowHeight","2em"],[1,"team-img",3,"src"]],template:function(t,a){1&t&&(e.YNc(0,_,2,2,"div",0),e.YNc(1,F,2,1,"div",1),e.YNc(2,N,2,1,"div",1)),2&t&&(e.Q6J("ngIf",a.iterations!==a.iterate),e.xp6(1),e.Q6J("ngIf",a.iterations===a.iterate),e.xp6(1),e.Q6J("ngIf",a.iterations===a.iterate))},directives:[h.O5,h.sg,b.Il,b.DX],styles:["h1[_ngcontent-%COMP%]{color:#fff;font-size:50px;font-weight:bolder}h2[_ngcontent-%COMP%]{color:#fff;font-size:20px;margin-bottom:0}h3[_ngcontent-%COMP%]{color:#fff;font-size:15px;margin-bottom:0}a[_ngcontent-%COMP%]{color:#5eccd6;border-bottom:2px solid transparent;transition:.5s border-bottom}.dashboard-header[_ngcontent-%COMP%]{align-items:center;box-sizing:border-box;display:flex;flex-direction:column;padding-top:1%}.dashboard-content[_ngcontent-%COMP%]{display:block;margin-top:10px}.game-flex-item[_ngcontent-%COMP%]{flex-grow:5;margin-right:10px}.pick-flex-item[_ngcontent-%COMP%]{flex-grow:4;margin-right:10px}.score-flex-item[_ngcontent-%COMP%]{flex-grow:1}.flexExpand[_ngcontent-%COMP%]{flex:1 1 auto}@media (max-width: 768px){.dashboard-content[_ngcontent-%COMP%]{display:block}.game-flex-item[_ngcontent-%COMP%], .pick-flex-item[_ngcontent-%COMP%]{margin-right:0}}.week-selector[_ngcontent-%COMP%]{margin-top:5px;background-color:#fff;width:min-content;height:51px}.list-container[_ngcontent-%COMP%]{margin-bottom:8px}.mat-grid-list[_ngcontent-%COMP%]{max-width:400px}.mat-grid-tile[_ngcontent-%COMP%]{border-width:1px;border-style:solid;border-color:#1e1e1e;background-color:#464646}.team-name[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;height:100%}.game-status[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;height:100%;color:#fff;padding-left:3px}.game-status-mini[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;height:100%;border-left:1px;border-style:solid;border-color:#1e1e1e;padding-left:3px;font-size:.6em}.team-img[_ngcontent-%COMP%]{font-weight:700;padding-left:2px;padding-right:2px;max-height:1.5em}.team-img-mini[_ngcontent-%COMP%]{padding-left:5px;padding-right:5px;max-height:1em}.tie[_ngcontent-%COMP%]{color:#dcdc28}.win[_ngcontent-%COMP%]{color:#5fff5f}.lose[_ngcontent-%COMP%]{color:#ff5f5f}.no-contest[_ngcontent-%COMP%]{color:#fff}"]}),o})()}];let j=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[O.Bz.forChild(Y)],O.Bz]}),o})(),z=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[h.ez,j,b.N6]]}),o})()}}]);