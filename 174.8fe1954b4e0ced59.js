"use strict";(self.webpackChunkag_curl=self.webpackChunkag_curl||[]).push([[174],{3174:(_,x,c)=>{c.r(x),c.d(x,{SimulatorModule:()=>N});var g=c(177),O=c(3885),v=c(467),D=c(4412),w=c(6648),M=c(3207);class h{constructor(n){this.teamData={},n.forEach(t=>{t.homeTeamAbbr in this.teamData||(this.teamData[t.homeTeamAbbr]={score:0,round:0,results:[]}),t.awayTeamAbbr in this.teamData||(this.teamData[t.awayTeamAbbr]={score:0,round:0,results:[]}),this.teamData[t.homeTeamAbbr].score+=t.homeAwardedPoints,this.teamData[t.homeTeamAbbr].round=Math.max(this.teamData[t.homeTeamAbbr].round,t.round),this.teamData[t.homeTeamAbbr].results.push(t),this.teamData[t.awayTeamAbbr].score+=t.awayAwardedPoints,this.teamData[t.awayTeamAbbr].round=Math.max(this.teamData[t.awayTeamAbbr].round,t.round),this.teamData[t.awayTeamAbbr].results.push(t)})}add(n){for(const[t,a]of Object.entries(n.teamData))this.teamData[t].round+=a.round,this.teamData[t].score+=a.score;return this}divide(n){for(const t of Object.keys(this.teamData))this.teamData[t].round/=n,this.teamData[t].score/=n;return this}raw(){const n=[];for(const[t,a]of Object.entries(this.teamData))n.push({abbr:t,score:a.score,round:a.round});return n.sort((t,a)=>a.score-t.score)}static blank(n){const t=new h([]);return n.all().forEach(a=>{a.rank>0&&(t.teamData[a.abbr]={score:0,round:0,results:[]})}),t}}var e=c(4438),y=c(7137),P=c(6349),T=c(9182),A=c(5889),b=c(6195);function F(r,n){if(1&r&&(e.j41(0,"div",2),e.EFF(1),e.k0s()),2&r){const t=e.XpG();e.R7$(),e.Lme("Progress (",t.iterations," Iterations): ",(t.iterate/t.iterations*100).toFixed(0),"%")}}function S(r,n){if(1&r&&(e.j41(0,"mat-grid-list",5)(1,"mat-grid-tile",6)(2,"div",2),e.EFF(3),e.k0s()(),e.j41(4,"mat-grid-tile",6)(5,"div",2),e.EFF(6),e.k0s()()()),2&r){const t=n.$implicit;e.R7$(3),e.JRh(t[0]),e.R7$(3),e.SpI("",t[1],"%")}}function R(r,n){if(1&r&&(e.j41(0,"div",3),e.DNE(1,S,7,2,"mat-grid-list",4),e.k0s()),2&r){const t=e.XpG();e.R7$(),e.Y8G("ngForOf",t.metaDraftSorted)}}function E(r,n){if(1&r&&(e.j41(0,"mat-grid-list",8)(1,"mat-grid-tile",6)(2,"div",2),e.nrm(3,"img",9),e.EFF(4),e.k0s()(),e.j41(5,"mat-grid-tile",6)(6,"div",2),e.EFF(7),e.k0s()(),e.j41(8,"mat-grid-tile",6)(9,"div",2),e.EFF(10),e.k0s()()()),2&r){const t=n.$implicit,a=e.XpG(2);e.R7$(3),e.FS9("src",a.teamdb.get(t.abbr).imgURL,e.B4B),e.R7$(),e.JRh(a.teamdb.get(t.abbr).cleanName()),e.R7$(3),e.JRh(t.score.toFixed(3)),e.R7$(3),e.JRh(t.round.toFixed(2))}}function $(r,n){if(1&r&&(e.j41(0,"div",3),e.DNE(1,E,11,4,"mat-grid-list",7),e.k0s()),2&r){const t=e.XpG();e.R7$(),e.Y8G("ngForOf",t.metaResult.raw())}}const j=r=>new Promise(n=>setTimeout(n,r));function G(r,n){r.forEach(a=>{a.group&&(n[a.group][a.homeTeamAbbr].score+=a.homeAwardedPoints,n[a.group][a.homeTeamAbbr].simulations.push(a),n[a.group][a.awayTeamAbbr].score+=a.awayAwardedPoints,n[a.group][a.awayTeamAbbr].simulations.push(a))});const t={};for(const[a,s]of Object.entries(n)){a in t||(t[a]=[]);for(const[m,i]of Object.entries(s))t[a].push({abbr:m,logOdds:i.logOdds,score:i.score,group:a});t[a].sort((m,i)=>{const d=s[m.abbr],u=s[i.abbr];if(d.score===u.score){const f=d.simulations.filter(l=>l.homeTeamAbbr===i.abbr||l.awayTeamAbbr===i.abbr);if(0===f.length)return Math.random()-.5;const o=f[0];return o.homeAwardedPoints===o.awayAwardedPoints?Math.random()-.5:o.winnerTeamAbbr===m.abbr?-1:1}return u.score-d.score})}return t[3]=Object.entries(t).map(([a,s])=>s[2]),t[3].sort((a,s)=>{const m=n[a.group][a.abbr],i=n[s.group][s.abbr];return m.score===i.score?Math.random()-.5:i.score-m.score}),t}const I=[{path:"",component:(()=>{class r{constructor(t,a,s,m){this.uefaapi=t,this.teamdb=a,this.userdb=s,this.draftdb=m,this.iterate=0,this.iterations=5e4}ngOnInit(){var t=this;return(0,v.A)(function*(){t.allGamesSub$=new D.t(new Array),t.allGames$=t.allGamesSub$.asObservable(),t.allDrafts$=(0,w.H)([t.draftdb.drafts]),t.updateGames().then(function(){var a=(0,v.A)(function*(s){for(s.sort((i,d)=>i.id-d.id),t.metaResult=h.blank(t.teamdb),t.metaDraft={},t.userdb.all().forEach(i=>{t.metaDraft[i.name]=[0,0,0,0,0,0,0,0]}),t.iterate=0;t.iterate<t.iterations;t.iterate++){t.iterate%500==0&&(yield j(0));const i=[];s.forEach(o=>o.reinitialize()),t.teamdb.all().forEach(o=>o.resetGames()),s.filter(o=>0===o.round).forEach(o=>{i.push(o.simulate(!0,i))});const d=G(i,t.teamdb.teamsByGroup());s.filter(o=>o.round>0).forEach(o=>{i.push(o.simulate(!1,i,d))});const u=new h(i);t.metaResult.add(u);const f=[];t.draftdb.drafts.forEach(o=>{const l=[];let C=0;o.teams.forEach(p=>{l.push([p.abbr,u.teamData[p.abbr]]),C+=u.teamData[p.abbr].score}),f.push([o.user.name,C,l])}),f.sort((o,l)=>Number(l[1])-Number(o[1]));for(let o=0,l=0;o<f.length;o++)o>0&&(f[o-1][1]!==f[o][1]&&(l=o)),t.metaDraft[String(f[o][0])][l]++}t.metaResult.divide(t.iterations),t.metaDraftSorted=[];for(const[i,d]of Object.entries(t.metaDraft))t.metaDraftSorted.push([i,d[0]/(t.iterations/100)]);t.metaDraftSorted.sort((i,d)=>Number(d[1])-Number(i[1])),t.allGamesSub$.next(s.filter(i=>i.round>=0))});return function(s){return a.apply(this,arguments)}}())})()}updateGames(){return(0,M.s)(this.uefaapi.getGames())}static#t=this.\u0275fac=function(a){return new(a||r)(e.rXU(y.L),e.rXU(P.g),e.rXU(T.E),e.rXU(A.c))};static#e=this.\u0275cmp=e.VBU({type:r,selectors:[["app-simulator"]],decls:3,vars:3,consts:[["class","game-status",4,"ngIf"],["class","list-container",4,"ngIf"],[1,"game-status"],[1,"list-container"],["cols","2","rowHeight","2em",4,"ngFor","ngForOf"],["cols","2","rowHeight","2em"],["colspan","1"],["cols","3","rowHeight","2em",4,"ngFor","ngForOf"],["cols","3","rowHeight","2em"],[1,"team-img",3,"src"]],template:function(a,s){1&a&&e.DNE(0,F,2,2,"div",0)(1,R,2,1,"div",1)(2,$,2,1,"div",1),2&a&&(e.Y8G("ngIf",s.iterations!==s.iterate),e.R7$(),e.Y8G("ngIf",s.iterations===s.iterate),e.R7$(),e.Y8G("ngIf",s.iterations===s.iterate))},dependencies:[g.Sq,g.bT,b.B_,b.NS],styles:["h1[_ngcontent-%COMP%]{color:#fff;font-size:50px;font-weight:bolder}h2[_ngcontent-%COMP%]{color:#fff;font-size:20px;margin-bottom:0}h3[_ngcontent-%COMP%]{color:#fff;font-size:15px;margin-bottom:0}a[_ngcontent-%COMP%]{color:#5eccd6;border-bottom:2px solid transparent;transition:.5s border-bottom}.dashboard-header[_ngcontent-%COMP%]{align-items:center;box-sizing:border-box;display:flex;flex-direction:column;padding-top:1%}.dashboard-content[_ngcontent-%COMP%]{display:block;margin-top:10px}.game-flex-item[_ngcontent-%COMP%]{flex-grow:5;margin-right:10px}.pick-flex-item[_ngcontent-%COMP%]{flex-grow:4;margin-right:10px}.score-flex-item[_ngcontent-%COMP%]{flex-grow:1}.flexExpand[_ngcontent-%COMP%]{flex:1 1 auto}@media (max-width: 768px){.dashboard-content[_ngcontent-%COMP%]{display:block}.game-flex-item[_ngcontent-%COMP%], .pick-flex-item[_ngcontent-%COMP%]{margin-right:0}}.week-selector[_ngcontent-%COMP%]{margin-top:5px;background-color:#fff;width:min-content;height:51px}.list-container[_ngcontent-%COMP%]{margin-bottom:8px}.mat-grid-list[_ngcontent-%COMP%]{max-width:400px}.mat-grid-tile[_ngcontent-%COMP%]{border-width:1px;border-style:solid;border-color:#1e1e1e;background-color:#464646}.team-name[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;height:100%}.game-status[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;height:100%;color:#fff;padding-left:3px}.game-status-mini[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;height:100%;border-left:1px;border-style:solid;border-color:#1e1e1e;padding-left:3px;font-size:.6em}.team-img[_ngcontent-%COMP%]{font-weight:700;padding-left:2px;padding-right:2px;max-height:1.5em}.team-img-mini[_ngcontent-%COMP%]{padding-left:5px;padding-right:5px;max-height:1em}.tie[_ngcontent-%COMP%]{color:#dcdc28}.win[_ngcontent-%COMP%]{color:#5fff5f}.lose[_ngcontent-%COMP%]{color:#ff5f5f}.no-contest[_ngcontent-%COMP%]{color:#fff}"]})}return r})()}];let k=(()=>{class r{static#t=this.\u0275fac=function(a){return new(a||r)};static#e=this.\u0275mod=e.$C({type:r});static#a=this.\u0275inj=e.G2t({imports:[O.iI.forChild(I),O.iI]})}return r})(),N=(()=>{class r{static#t=this.\u0275fac=function(a){return new(a||r)};static#e=this.\u0275mod=e.$C({type:r});static#a=this.\u0275inj=e.G2t({imports:[g.MD,k,b.Fe]})}return r})()}}]);